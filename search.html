<!DOCTYPE html>
<html>

<head>
    <title>Search</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
    <header id="statusHeader">
        <!--inputs e-mail and password show after clicking on sign in()-->
        <p>
            <!--e-mail: <input id="e-mail" type="text"> password: <input id="password" type="password">-->
            <button onclick="login()">Sign In</button> <button onclick="register()">Sign Up</button>
        </p>
    </header>
    <header id="bannerHeader">
        <div id="banner">
            <h1>Find drug adverse event</h1>
        </div>
    </header>
    <div id="searchInput">
        <p>Drug name: <input id="brand" type="text"> Manufacturer name: <input id="manufacturer" type="text"> <button onclick="search()">Search</button></p>
    </div>
    <div id="result">
        <table id="resultTable" border=1>
            <thead>
                <tr>
                    <th>Drug name</th>
                    <th>Manufacturer name</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <div id="drugAdverseEvent">
        <table id="drugAdverseEventTable" border=1>
            <thead>
                <tr>
                    <th>Reaction</th>
                    <th>Quantity</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <button id="closeButton">Close</button>
    </div>
    <script>
        $(document).ready(function() {
            hideDiv($("#drugAdverseEvent"))
        });

        $("#closeButton").on("click", function() {
            hideDiv($("#drugAdverseEvent"))
        })

        function search() {
            hideDiv($("#drugAdverseEvent"))
            $("#resultTable tbody").empty()
            $("#drugAdverseEventTable tbody").empty()
            $.post("", {
                    find: 'drug',
                    brand: $("#brand").val(),
                    manufacturer: $("#manufacturer").val()
                },
                function(data, status) {
                    for (obj in data) {
                        var row = $('<tr></tr>')
                        for (key in data[obj]) {
                            column = $('<td></td>').text(data[obj][key])
                            row.append(column)
                        }
                        row.on('click', make)
                        $("#resultTable tbody").append(row)
                    }
                }
            );
        };

        function make() {
            $.post("", {
                    find: 'reaction',
                    brand: $($(this).children()[0]).text(),
                    manufacturer: $($(this).children()[1]).text()
                },
                function(data, status) {
                    $("#drugAdverseEventTable tbody").empty()
                    for (obj in data) {
                        var row = $('<tr></tr>')
                        for (key in data[obj]) {
                            column = $('<td></td>').text(data[obj][key])
                            row.append(column)
                        }
                        $("#drugAdverseEventTable tbody").append(row)
                    }
                }
            );
            $("#drugAdverseEvent").show()
        }

        function hideDiv(div) {
            $(div).hide()
        }

    </script>
</body>

</html>
